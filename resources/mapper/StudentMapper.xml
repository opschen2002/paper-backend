<!-- 在现有的mapper文件中添加如下查询 -->
<select id="getStudentHistoryScores" resultType="com.physical.dto.StudentScoreDTO">
    SELECT 
        s.student_id,
        s.name,
        s.class_name,
        s.college,
        b.test_date,
        b.height,
        b.weight,
        b.run_50m,
        b.long_jump,
        b.vital_capacity,
        b.sit_and_reach,
        CASE 
            WHEN s.gender = 'male' THEN m.total_score
            ELSE f.total_score
        END as total_score,
        CASE 
            WHEN s.gender = 'male' THEN m.run_1000m
            ELSE f.run_800m
        END as long_run,
        CASE 
            WHEN s.gender = 'male' THEN m.pull_up
            ELSE f.sit_up
        END as strength_test
    FROM students s
    LEFT JOIN basic_physical_scores b ON s.student_id = b.student_id
    LEFT JOIN male_physical_scores m ON s.student_id = m.student_id AND s.gender = 'male'
    LEFT JOIN female_physical_scores f ON s.student_id = f.student_id AND s.gender = 'female'
    WHERE s.student_id = #{studentId}
    ORDER BY b.test_date DESC
</select>